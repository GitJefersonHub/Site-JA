<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <title>Painel do Usuário</title>
  <link rel="stylesheet" href="css/painel.css">
</head>

<body>

  <script>
    // Proteção contra acesso direto sem login
    if (localStorage.getItem('usuarioLogado') !== 'true') {
      alert('Acesso não autorizado. Faça login para continuar.');
      location.replace('login.html');
    }

    // Carrega dados do usuário logado
    const dados = JSON.parse(localStorage.getItem('dadosUsuario'));

    if (!dados || !dados.nome || !dados.matricula || !dados.telefone || !dados.email || !dados.senha) {
      alert('Dados de usuário inválidos. Faça login novamente.');
      localStorage.removeItem('usuarioLogado');
      localStorage.removeItem('dadosUsuario');
      location.replace('login.html');
    }

    // Saudação com base no horário
    function gerarSaudacao(nome) {
      const hora = new Date().getHours();
      let saudacao = 'Olá';

      if (hora >= 5 && hora < 12) {
        saudacao = 'Bom dia';
      } else if (hora >= 12 && hora < 18) {
        saudacao = 'Boa tarde';
      } else {
        saudacao = 'Boa noite';
      }

      return `${saudacao}, ${nome}!`;
    }
  </script>

  <div class="painel-container">
    <h2 id="boasVindas"></h2>
    <div class="info" id="infoNome">📌 Nome: </div>
    <div class="info" id="infoMatricula">📌 Matrícula: </div>
    <div class="info" id="infoTelefone">📞 Telefone: </div>
    <div class="info" id="infoEmail">📧 E-mail: </div>
    <p class="lembrete">🔐 Lembre-se: Guarde suas informações de login.</p>

    <div class="actions">
      <button class="btn-ponto" onclick="registrar()">Ponto</button>
      <button class="btn-relatorios" onclick="window.location.href='relatorios.html'">Relatórios</button>
      <button class="btn-ESE" onclick="editarPerfil()">Editar / Salvar / Excluir</button>

      <div id="formCadastro" style="display: none; flex-direction: column; gap: 10px; margin-top: 20px;">
        <label>Nome:</label>
        <input type="text" id="cadNome">

        <label>Matrícula:</label>
        <input type="text" id="cadMatricula" maxlength="6">

        <label>Telefone:</label>
        <input type="tel" id="cadTelefone" placeholder="(99) 99999-9999">

        <label>E-mail:</label>
        <input type="email" id="cadEmail">

        <label>Senha:</label>
        <input type="password" id="cadSenha" maxlength="6">

        <button onclick="salvarNovoUsuario()">Enviar</button>
      </div>

      <div id="formEditar">
        <label>Nome:</label>
        <input type="text" id="editNome">

        <label>Matrícula:</label>
        <input type="text" id="editMatricula">

        <label>Telefone:</label>
        <input type="tel" id="editTelefone" placeholder="(99) 99999-9999">

        <label>E-mail:</label>
        <input type="email" id="editEmail">

        <label>Senha:</label>
        <div style="position: relative; display: flex; align-items: center;">
          <input type="password" id="editSenha" maxlength="6" style="flex: 1; padding-right: 15%;">
          <span id="toggleIcon" onclick="toggleSenha()" style="
            position: absolute;
            right: 4%;
            top: 50%;
            transform: translateY(-50%);
            font-size: 400%;
            cursor: pointer;
            color: #007bff;
            user-select: none;
          ">👁️</span>
        </div>
        <button class="btn-salvar" onclick="salvarPerfil()">Salvar Alterações</button>
        <button class="btn-excluir" onclick="excluir()">Excluir Cadastro</button>
      </div>
      <button class="btn-sair" onclick="sair()">Sair</button>
      <button class="btn-lista" onclick="imprimirLista()">Lista</button>
    </div>

  </div>

  <script src="js/painel/relatorios.js"></script>
  <script src="js/painel/editarPerfil.js"></script>
  <script src="js/painel/lista.js"></script>
  <script src="js/painel/excluir.js"></script>
  <script src="js/painel/sair.js"></script>

</body>

</html>