<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Relatórios</title>

  <!-- Estilos -->
  <link rel="stylesheet" href="css/relatorios.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Open+Sans:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="icon" href="data:,">
</head>

<body>
  <main>
    <!-- Tabela de ponto -->
    <section id="tabelaPonto"></section>

    <!-- Tabela de QR Code -->
    <section id="tabelaQRCode"></section>
  </main>

  <!-- Inicialização: proteger acesso e expor dados do usuário para os relatórios -->
  <script>
    (function initRelatoriosContext() {
      const usuarioLogado = localStorage.getItem('usuarioLogado');
      const dadosUsuario = JSON.parse(localStorage.getItem('dadosUsuario') || '{}');

      // Proteção de acesso
      if (!usuarioLogado || !dadosUsuario || !dadosUsuario.nome || !dadosUsuario.matricula || !dadosUsuario.posto || !dadosUsuario.localizacao) {
        alert('Acesso inválido. Faça login novamente.');
        localStorage.removeItem('usuarioLogado');
        localStorage.removeItem('dadosUsuario');
        location.replace('rondasLogin.html');
        return;
      }

      // Expor global para scripts de relatório
      window.dadosUsuario = dadosUsuario;
    })();
  </script>

  <!-- Scripts em ordem correta (usar defer) -->
  <script src="js/rondas/relatoriosBase.js" defer></script>
  <script src="js/rondas/relatoriosPonto.js" defer></script>
  <script src="js/rondas/relatoriosQRCode.js" defer></script>
  
</body>
</html>
